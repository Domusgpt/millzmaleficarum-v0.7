# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Status
- **Current Version: 0.7-dev** (Upgraded from v0.6 with immersive dimensional worlds)
- HyperAV visualization expanded to universal environment rather than contained boxes
- Separate dimensional worlds for each section instead of scroll-based navigation
- Enhanced text animations with advanced reality distortion effects
- Hyperdimensional magazine with inter-dimensional travel between content sections

## Headless Claude Integration
- The system now uses a headless instance of Claude Code to:
  - Generate evolving content for the magazine
  - Modify CSS animations and effects for daily variations
  - Create increasingly bizarre and cryptic text content
  - Generate visual prompts for images
  - Evolve the magazine aesthetic over time
  - Create dynamic reality-distortion effects

## Commands
- **Run locally**: `npm start` or `./run-local.sh`
- **Deploy to Fly.io**: `./fly-deploy.sh`
- **HyperAV integration**: `./hyperav-sync.sh` 
- **Lint shell scripts**: `shellcheck filename.sh`
- **Test**: Run `npm test` (no tests specified yet)
- **Use Claude Code**: Run the claude-millz.sh script (in Ubuntu PRoot)
- **Run headless content generation**: `./yolo-task.sh`
- **Apply automated improvements**: `./yolo-improve.sh`

## Ridiculous Animation Principles
- **Dimensional Rifts**: Create portal-like tears in space between sections
- **Reality Distortion**: Elements should warp, glitch and fracture
- **Hyperdimensional Effects**: Use 4D visualization for transitions
- **Audio Reactivity**: All visual elements should respond to audio input
- **Depth Overload**: Extreme parallax and z-depth manipulation
- **Bombastic Transitions**: Transitions should be dramatic and overwhelming
- **Visual Chaos**: Increase glitch effects and reality disruptions
- **Nested Dimensions**: Create "windows" to impossible spaces
- **Time Manipulation**: Elements should appear to speed up, slow down or reverse
- **Sensory Overload**: Combine multiple effects for overwhelming experience

## Code Style Guidelines
- **JavaScript**:
  - Use ES6+ features (arrow functions, template literals, destructuring)
  - Prefer functional programming patterns for data transformation
  - Add JSDoc comments for documentation (`@param`, `@returns`)
  - Handle errors with try/catch blocks and detailed error messages
  - Use camelCase for variables and functions, PascalCase for classes
  - Create clearly named component functions for UI elements
  - Incorporate WebGL shaders for advanced visual effects
  - Use requestAnimationFrame for smooth animations
  - Implement AudioContext API for sound reactivity

- **CSS**:
  - Use CSS variables for theming (defined in `:root`)
  - Follow mobile-first responsive design principles
  - Namespace classes by section (e.g., `editorial-section`, `tech-content`)
  - Organize 3D transformations and animations into logical groups
  - Implement extreme perspective transformations
  - Use blend modes for visual overlay effects
  - Employ CSS animations for baseline effects
  - Leverage filter effects for distortion
  - Create impossibly nested 3D spaces with transform-style: preserve-3d

- **HTML/JSON**:
  - Use semantic HTML5 elements
  - Structure JSON with nested objects for better organization
  - Include metadata and configuration in JSON for rendering instructions
  - Maintain backward compatibility with legacy formats
  - Add data attributes for JavaScript targeting
  - Structure content for dynamic manipulation

## Headless Claude Code Integration
- Content is generated using the headless Claude integration
- The `yolo-task.sh` script handles content generation workflows
- Claude generates:
  - New magazine sections and content
  - Shader code for WebGL effects
  - CSS animations and transformations
  - Audio synthesis parameters
  - Visual prompts for images
  - Reality distortion algorithms

## Error Handling
- Server: Use try/catch blocks with detailed error logging
- Client: Implement graceful degradation with user-friendly error messages
- JSON parsing: Validate content structure before rendering
- Animation failures: Fall back to simpler effects when complex ones fail
- WebGL detection: Provide fallbacks for devices without WebGL support

## Imports
- Group imports by type (core modules, npm packages, local modules)
- Use destructuring for specific imports where applicable
- Avoid wildcard imports

## Important Files
- `server.js`: Express API server with magazine data endpoints
- `public/script.js`: Frontend rendering with layout and navigation
- `public/style.css`: CSS with advanced 3D effects and responsive design
- `public/hyperav.js`: 4D visualization engine integration
- `public/reactive-animations.js`: Micro-animation system with reactive elements
- `public/infinite-scroll.js`: Infinite scrolling with glitchy transitions
- `public/hyperav-audio.js`: Audio reactivity for visualization engine
- `public/enhancement-loader.js`: Performance-aware feature loading system
- `public/portal-transitions.js`: Hyperdimensional portal transition effects
- `tools/yolo_status.json`: Status file for headless Claude integration

## Animation and Effect Systems
- **Portal Transitions**: Creates hyperdimensional portal effects between sections
- **HyperAV Visualization**: 4D visualization engine for background effects
- **Audio Reactivity**: System that connects audio analysis to visual elements
- **Reality Distortion**: Creates glitches, tears, and distortions in content
- **Reactive Animations**: Mouse-reactive text and UI elements
- **Performance Optimization**: Adaptive system that scales effects based on device capabilities

## Content Evolution
- Content should become increasingly cryptic and surreal
- Visual elements should mutate over time
- Color schemes should shift toward more unusual combinations
- Animations should become more extreme and reality-breaking
- Text should introduce increasingly bizarre concepts and terminology
- Transitions should become more dramatic and disorienting